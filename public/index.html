<!DOCTYPE HTML>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<title>MTGA Draft</title>
	<meta name="description" content="Draft with your friends using your Magic Arena card collection.">
	<meta name="keywords" content="Magic, Arena, Magic the Gathering, MTG, Magic Arena, MTGA, Booster, Limited, Sealed, Draft, Friend, Direct Challenge">
	<meta property="og:title" content="MTGA Draft">
	<meta property="og:type" content="website">
	<meta property="og:url" content="https://mtgadraft.herokuapp.com/">
	<meta property="og:image" content="https://upload.wikimedia.org/wikipedia/en/a/aa/Magic_the_gathering-card_back.jpg">
	<meta property="og:description" content="Draft with your friends using your Magic Arena card collection.">
	<meta property="og:site_name" content="MTGA Draft">

	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
	<link rel="stylesheet" href="https://unpkg.com/vue-multiselect@2.1.0/dist/vue-multiselect.min.css">
	<link rel="stylesheet" href="css/style.css" />
	<link rel="stylesheet" href="css/modal.css" />

	<script type="text/x-template" id="modal-template">
	  <transition name="modal">
		<div class="modal-mask">
		  <div class="modal-wrapper" @click="if($event.target == $event.currentTarget) $emit('close')">
			<div class="modal-container">

			  <div class="modal-header">
				<slot name="header">
				  ???
				</slot>
				<i @click="$emit('close')" class="fa fa-times fa-lg modal-default-button clickable" aria-hidden="true"></i>
			  </div>

			  <div class="modal-body">
				<slot name="body">
				  Loading...
				</slot>
			  </div>

			  <div class="modal-footer">
				<slot name="footer">
				</slot>
			  </div>
			</div>
		  </div>
		</div>
	  </transition>
	</script>
</head>
<body>
	<div id="main-vue">
		<div v-show="cards == undefined">
			<div class="loading"></div>
			<span>Loading cards data...</span>
		</div>
		
		<div id="view-controls" class="main-controls">
			<span>
				<label for="user-name">User Name</label><input type="text" id="user-name" name="user-name" v-model="userName" maxlength="50" />
				<span class="v-separator"></span>
				<label for="language" title="Controls the display language of cards.">Language</label>
				<select v-model="language" name="language">
					<option v-for="lang in languages" v-bind:value="lang.code">{{ lang.name }}</option>
				</select>
				<span class="v-separator"></span>
				<label for="file-input">MTGA Collection</label><input type="file" id="file-input" @change="parseMTGALog" style="display:none" accept=".txt" /><button onclick="document.querySelector('#file-input').click()" title="Import your collection by uploading your output_log.txt">Upload <i v-if="hasCollection" class="fas fa-check green" title="Collection uploaded."></i></button>
				<button v-if="hasCollection" title="Stats." @click="showCollectionStats = true">Stats</button>
				<span  v-show="Object.keys(collection).length > 0">
					<input type="checkbox" v-model="useCollection" id="useCollection" title="Uncheck this to draft using every cards." />
					<label for="useCollection">Restrict to Collection</label>
				</span>

				<span class="v-separator" title="If enabled, you will be notified when a draft is launched."></span>
				<input type="checkbox" v-model="pickOnDblclick" id="pickOnDblclick" title="Allows you to pick cards by double clicking." /><label for="pickOnDblclick">Pick on Double Click</label>
				<span :class="{ disabled: notificationPermission == 'denied' }">
					<input type="checkbox" v-model="enableNotifications" @change="checkNotificationPermission" id="notification-input" /><label for="notification-input">Notifications</label>
				</span>
			</span>
			
			<span class="generic-container">
				<div v-show="publicSessions.length == 0" class="disable-warning">
					(No public sessions)
				</div>
				<span v-bind:class="{ disabled: drafting || publicSessions.length == 0 }" id="public-session-controls">
					<label for="public-sessions">Public sessions</label>
					<select id="public-sessions" v-model:value="selectedPublicSession">
						<option v-for="s in publicSessions" v-bind:value="s">
						{{ s }}
						</option>
					</select>
					<input type="button" value="Join" @click="joinPublicSession"/>
				</span>
			</span>
		</div>
		<div class="generic-container">
			<div id="limited-controls" class="main-controls" v-bind:class="{ disabled: drafting }">
				<span id="session-controls">
					<label for="session-id" title="Share it with your friends!">Session ID</label>
					<input :type="hideSessionID ? 'password' : 'text'" id="session-id" v-model="sessionID" />
					<i class="far fa-fw clickable" :class="hideSessionID ? 'fa-eye' : 'fa-eye-slash'" @click="hideSessionID = !hideSessionID" title="Show/Hide your session ID."></i>
					<i class="fas fa-share-square clickable" style="padding:4px" title="Share" @click="sessionURLToClipboard"></i>
					<button v-if="sessionOwner === userID" @click="readyCheck" title="Ask everyone in your session if they're ready to play.">Ready Check</button>
				</span>
				<span class="generic-container">
					<span v-bind:class="{ disabled: sessionOwner != userID }">
						<span  class="generic-container">
							<strong>Session options:</strong>
							<template v-if="useCustomCardList">
							Using Custom Card List ({{customCardList.length}} cards)
							</template>
							<template v-else>
							<input type="checkbox" v-model="ignoreCollections" id="ignore-collections" title="Ignore players collection: Draft with all cards." /><label for="ignore-collections" title="Ignore players collection: Draft with all cards.">Ignore Collections</label>
							<label for="set-restriction">Set(s)</label>
							<multiselect v-if="setsInfos" v-model="setRestriction" placeholder="All" :options="sets" :searchable="false" :allow-empty="true" :close-on-select="false" :multiple="true" select-label="" deselect-label="Remove">
								<template slot="selection" slot-scope="{ values, search, isOpen }">
									<span class="multiselect__single" v-if="values.length == 1"><img class="set-icon" :src="setsInfos[values[0]].icon"> {{ setsInfos[values[0]].fullName }}</span>
									<span class="multiselect__single multiselect__single_nooverflow" v-if="values.length > 1">({{ values.length }})
										<img v-for="v in values" class="set-icon" :src="setsInfos[v].icon">
									</span>
								</template>
								<template slot="option" slot-scope="{ option , search  }"><span class="multiselect__option">{{ setsInfos[option].fullName }}</span></template>
							</multiselect>
							</template>
							<i class="fas fa-ellipsis-v clickable" style="padding:4px" title="More options" @click="showSessionOptionsDialog = !showSessionOptionsDialog"></i>
						</span>
						<span class="v-separator"></span>
						<span>
							<strong>Draft:</strong>
							<label for="bots">Bots</label><input type="number" id="bots" class="small-number-input" min="0" max="7" step="1" v-model.number="bots" />
							<label for="timer" title="Pick Timer (sec.). Zero means no timer."><i class="fas fa-clock"></i></label><input type="number" id="timer" class="small-number-input" min="0" max="120" step="30" v-model.number="maxTimer" />
							<button @click="startDraft">Start Draft</button>
						</span>
						<span class="v-separator"></span>
						<span>
							<button @click="sealedDialog">Start Sealed</button>
						</span>
					</span>
					<div v-show="sessionOwner != userID" class="disable-warning">
						(Session owner only)
					</div>
				</span>
			</div>
			<div v-show="drafting" id="draft-in-progress">
				Draft in progress!
				<button v-if="sessionOwner == userID" class="stop" @click="stopDraft">Stop Draft</button>
			</div>
		</div>
		<div class="main-controls session-players">
			<div>
				Session Players&nbsp;<span title="Maximum players can be adjusted in session options.">({{sessionUsers.length}}/{{maxPlayers}})</span>
			</div>
			<ul class="player-list">
				<li v-for="user in virtualPlayers" :title="`${user.userName} (${user.userID})`" :class="{bot: user.isBot}">
					<i class="fas fa-angle-double-left passing-order-left" v-show="drafting && (draftRound % 2) == 1" title="Passing order"></i>
					<i class="fas fa-angle-double-right passing-order-right" v-show="drafting && (draftRound % 2) == 0" title="Passing order"></i>
					<span class="player-name">{{ user.userName }}</span>
					<template v-if="!user.isBot">
					<div class="status-icons">
						<i v-if="user.userID == sessionOwner" class="fas fa-crown subtle-gold" :title="`${user.userName} is the session's owner.`"></i>
						<i v-if="userID == sessionOwner && user.userID != sessionOwner" class="fas fa-user-plus clickable subtle-gold" :title="`Give session ownership to ${user.userName}`" @click="setSessionOwner(user.userID)"></i>
						<i v-if="userID == sessionOwner && user.userID != sessionOwner" class="fas fa-user-slash clickable red" :title="`Remove ${user.userName} from the session`" @click="removePlayer(user.userID)"></i>
						<template v-if="!ignoreCollections && !drafting">
							<template v-if="Object.entries(user.collection).length === 0 && user.collection.constructor === Object">
								<i class="fas fa-book red" :title="user.userName + ' has not uploaded their collection yet.'"></i>
							</template>
							<template v-else>
								<i class="fas fa-book green" :title="user.userName + ' has uploaded their collection.'"></i>
							</template>
						</template>
						<template v-if="drafting">
							<template v-if="user.pickedThisRound">
								<i class="fas fa-check green" :title="user.userName + ' has picked a card.'"></i>
							</template>
							<template v-else>
								<i class="fas fa-spinner fa-spin" :title="user.userName + ' is thinking...'"></i>
							</template>
						</template>
						<template v-if="!drafting && pendingReadyCheck">
							<template v-if="user.readyState == ReadyState.Ready">
								<i class="fas fa-check green" :title="`${user.userName} is ready!`"></i>
							</template>
							<template v-else-if="user.readyState == ReadyState.NotReady">
								<i class="fas fa-times red" :title="`${user.userName} is NOT ready!`"></i>
							</template>
							<template v-else-if="user.readyState == ReadyState.Unknown">
								<i class="fas fa-spinner fa-spin" :title="`Waiting on ${user.userName} to respond...`"></i>
							</template>
						</template>
					</div>
					<div class="chat-bubble" :id="'chat-bubble-'+user.userID"></div>
					</template>
				</li>
			</ul>
			<div>
				<button @click="shareSavedDraftLog" v-show="savedDraftLog">Share saved Draft Log</button>
				<button @click="displayDraftLog = !displayDraftLog" v-show="draftLog">Draft Log</button>
			</div>
			<div class="chat">
				<form @submit.prevent="sendChatMessage">
					<input type="text" v-model="currentChatMessage" placeholder="Chat with players in your session."  maxlength="255" />
				</form>
				<i class="far fa-comments clickable" @click="displayChatHistory = !displayChatHistory"></i>
				<div class="chat-history" v-show="displayChatHistory" @focusout="displayChatHistory = false" tabindex="0">
					<template v-if="messagesHistory && messagesHistory.length > 0">
						<ol>
							<li v-for="msg in messagesHistory.slice().reverse()" :title="new Date(msg.timestamp)">
								<span class="chat-author">{{ msg.author in userByID ? userByID[msg.author].userName : "(Left)"}}</span><span class="chat-message">{{msg.text}}</span>
							</li>
						</ol>
					</template>
					<template v-else>
						No messages in chat history.
					</template>
				</div>
			</div>
		</div>
		<template v-if="drafting">
			<div v-show="draftingState == DraftState.Picking" id="booster-container" class="container">
				<div id="booster-controls" class="controls">
					<h2>Your Booster</h2><span>Booster #{{ draftRound }}, Pick {{ ((deck.length + sideboard.length) % (useCustomCardList ? 15 : 14)) +1 }}</span><span v-show="pickTimer >= 0" :class="{redbg: pickTimer <= 10}" id="chrono"><i class="fas fa-clock"></i> {{ pickTimer }}</span>
					<input type="button" @click="pickCard" value="Confirm Pick" v-if="selectedCard != undefined"/>
				</div>
				<div class="booster card-container">
					<figure is="card" v-for="(card, index) in booster" v-bind:key="index" v-bind:card="card" v-bind:language="language" v-bind:selectcard="selectCard" v-bind:ondblclick="doubleClickCard" v-bind:selected="selectedCard === card"></figure>
				</div>
			</div>
			<div v-show="draftingState == DraftState.Waiting" class="pick-waiting">
				<span class="spinner"></span><span v-show="pickTimer >= 0">(<i class="fas fa-clock"></i> {{ pickTimer }})</span> Waiting for other players to pick...
			</div>
		</template>
		<div class="container" v-show="(deck !== undefined && deck.length > 0) || drafting || this.draftingState == DraftState.Brewing">
			<div id="brewing-controls" class="controls">
				<h2>Deck ({{deck.length}})</h2>
				<label for="card-order">Card Display</label>
				<select v-model="cardOrder" name="card-order">
					<option value="DraggableCMC">Draggable</option>
					<option value="CMCColumns">CMC Columns</option>
					<option value="ColorColumns">Color Columns</option>
					<option value="CMC">Order by CMC</option>
					<option value="Color">Order by Color</option>
					<option value="Rarity">Order by Rarity</option>
				</select>
				<button v-if="deck.length > 0" type="button" @click="exportDeck">Export Deck to MTGA</button>
				<span v-show="draftingState == DraftState.Brewing">
					<input type="checkbox" id="autoLand" v-model="autoLand"><label for="autoLand" title="If set, will complete your deck to 40 cards with basic lands.">Auto. Land</label>
					<label for="white-mana"><img src="img/mana/W.svg" class="mana-icon"></label><input class="small-number-input" type="number" id="white-mana" v-model.number="lands['W']" min="0" />
					<label for="blue-mana"><img src="img/mana/U.svg" class="mana-icon"></label><input class="small-number-input" type="number" id="blue-mana" v-model.number="lands['U']" min="0" />
					<label for="black-mana"><img src="img/mana/B.svg" class="mana-icon"></label><input class="small-number-input" type="number" id="black-mana" v-model.number="lands['B']" min="0" />
					<label for="red-mana"><img src="img/mana/R.svg" class="mana-icon"></label><input class="small-number-input" type="number" id="red-mana" v-model.number="lands['R']" min="0" />
					<label for="green-mana"><img src="img/mana/G.svg" class="mana-icon"></label><input class="small-number-input" type="number" id="green-mana" v-model.number="lands['G']" min="0" />
					{{totalLands}} basic lands for a total of {{deck.length + totalLands}} cards
				</span>
			</div>
			<div class="card-container" :class="['CMCColumns', 'ColorColumns', 'DraggableCMC'].includes(cardOrder) ? 'card-columns' : 'card-pool'">
				<div v-if="deck.length == 0" class="empty-warning">
					<h3>Your deck is currently empty!</h3>
					<p>Click on your cards to add them to your deck.</p>
				</div>
				<template v-if="cardOrder == 'DraggableCMC'">
					<draggable v-for="(column, colIdx) in deckColumn" :key="'deck'+colIdx" class="cmc-column drag-column" :list="column" group="cardColumn" @change="columnDeckChange">
					   <figure is="card" v-for="card in column" :key="card.uniqueID" v-bind:card="card" v-bind:language="language" v-bind:selectcard="deckToSideboard"></figure>
					</draggable>
					<div @click="deckColumn.push([])" class="plus-column"><i class="fas fa-plus fa-2x"></i></div>
				</template>
				<template v-else-if="cardOrder == 'CMCColumns'">
					<div v-for="cmc_column in deckColumnCMC" class="cmc-column">
						<figure is="card" v-for="(card, index) in cmc_column" v-bind:key="index" v-bind:card="card" v-bind:language="language" v-bind:selectcard="deckToSideboard"></figure>
					</div>
				</template>
				<template v-else-if="cardOrder == 'ColorColumns'">
					<div v-for="column in deckColumnColor" class="cmc-column" v-show="column.length > 0">
						<figure is="card" v-for="(card, index) in column" v-bind:key="index" v-bind:card="card" v-bind:language="language" v-bind:selectcard="deckToSideboard"></figure>
					</div>
				</template>
				<template v-else>
					<figure is="card" v-for="(card, index) in {'CMC': deckCMC, 'Color': deckColor, 'Rarity': deckRarity, '': deck}[cardOrder]" 
						v-bind:key="index" v-bind:card="card" v-bind:language="language" v-bind:selectcard="deckToSideboard"></figure>
				</template>
			</div>
		</div>
		<div v-show="(sideboard != undefined && sideboard.length > 0) || drafting || this.draftingState == DraftState.Brewing" id="card-pool-container" class="container">
			<div id="card-pool-controls" class="controls">
				<h2>Sideboard (<span id="sideboard-length" style="display:inline-block">{{sideboard.length}}</span>)</h2>
			</div>
			<div class="card-container" :class="['CMCColumns', 'ColorColumns', 'DraggableCMC'].includes(cardOrder) ? 'card-columns' : 'card-pool'">
				<div v-if="sideboard.length == 0" class="empty-warning">
					<h3>Your sideboard is currently empty!</h3>
					<p>Click on cards in your deck to sideboard them.</p>
				</div>
				<template v-if="cardOrder == 'DraggableCMC'">
					<draggable v-for="(column, colIdx) in sideboardColumn" :key="'side'+colIdx" class="cmc-column drag-column" :list="column" group="cardColumn" @change="columnSideboardChange">
					   <figure is="card" v-for="card in column" v-bind:key="card.uniqueID" v-bind:card="card" v-bind:language="language" v-bind:selectcard="sideboardToDeck"></figure>
					</draggable>
					<div @click="sideboardColumn.push([])" class="plus-column"><i class="fas fa-plus fa-2x"></i></div>
				</template>
				<template v-else-if="cardOrder == 'CMCColumns'">
					<div v-for="cmc_column in sideboardColumnCMC" class="cmc-column">
						<figure is="card" v-for="(card, index) in cmc_column" v-bind:key="index" v-bind:card="card" v-bind:language="language" v-bind:selectcard="sideboardToDeck"></figure>
					</div>
				</template>
				<template v-else-if="cardOrder == 'ColorColumns'">
					<div v-for="column in sideboardColumnColor" class="cmc-column" v-show="column.length > 0">
						<figure is="card" v-for="(card, index) in column" v-bind:key="index" v-bind:card="card" v-bind:language="language" v-bind:selectcard="sideboardToDeck"></figure>
					</div>
				</template>
				<template v-else>
					<figure is="card" v-for="(card, index) in {'CMC': sideboardCMC, 'Color': sideboardColor, 'Rarity': sideboardRarity, '': sideboard}[cardOrder]" 
						v-bind:key="index" v-bind:card="card" v-bind:language="language" v-bind:selectcard="sideboardToDeck"></figure>
				</template>
			</div>
		</div>
	<div class="welcome" v-if="draftingState === undefined">
			<h1>Welcome to MTGADraft!</h1>
			<p class="important">
				Want to draft in MTGA with your friends? Noticed you currently can't do that natively? We're here for you!
				<ol class="important">
					<li>
						(Optional) Import your collection: Enable Detailed logs in game, the toggle can be found in Options > View Account > Detailed Logs (Plugin Support), importing your collection won't work without this activated.
						<a onclick="document.querySelector('#file-input').click()">Upload your MTGA logs</a> (you should find them at <tt>C:\Users\%username%\AppData\LocalLow\Wizards Of The Coast\MTGA\output_log.txt</tt>) to restrict the draft to the cards you actually own in the game.
					</li>
					<li>Use the controls on top of the page to enter your User Name and indicate your preferences.</li>
					<li>Share your session ID with your friends (or join their own session) and wait for your session owner to start a draft!</li>
				</ol>
			</p>
			<h2>Options</h2>
			<div style="display: flex">
				<div style="width: 50%">
					Session options (Only accessible to the session owner, shared by everyone in your session):
					<ul>
						<li><span class="option-name">Ignore Collections</span>: Draft with all cards of the selected set(s), ignoring player collections and preferences. (Also affects sealed)</li>
						<li><span class="option-name">Set(s)</span>: Select one or multiple sets to draft using only with cards from these sets. (Also affects sealed)</li>
					(Click <i class="fa-ellipsis-v fa"></i> for these additional options:)
						<li><span class="option-name">Public</span>: Flags your session as public. It will appear in the "Public Sessions" menu so anyone can directly join.</li>
						<li><span class="option-name">Maximum Players</span>: Limits the number of players that can join your session.</li>
						<li><span class="option-name">Maximum Rarity</span>: Limits the maximum rarity of cards in your pool. (Default is Mythic, which means no restriction. Also affects sealed)</li>
						<li><span class="option-name">Color Balance</span>: If set, the system will attempt to smooth out the color distribution in each pack, as opposed to being completely random. (Also affects sealed)</li>
						<li><span class="option-name">Custom card list</span>: Submit a custom card list (one English card name by line) to draft your own cube.</li>
						<li><span class="option-name">Foil</span>: If enabled, each pack will have a chance to contain a 'foil' card of any rarity in place of one common.</li>
					(Draft options)
						<li><span class="option-name">Boosters per Player</span>: Defaults to 3.</li>
						<li><span class="option-name">Bots</span>: Adds virtual players to your draft. They are <strong>pretty dumb</strong>, but they are doing their best :(</li>
						<li><span class="option-name">Pick Timer</span>: Maximum time in seconds allowed to pick a card in each booster. Default is 60 seconds, 0 means the timer is disabled.</li>
					</ul>
				</div>
				<div style="width: 50%">
					Personal options:
					<ul>
						<li><span class="option-name">Language</span>: Adjusts the display language of cards.</li>
						<li><span class="option-name">Restrict to Collection</span>: If unchecked, your collection will not limit the cards available. If every players unchecks this, you will draft using every cards. (Particularly useful if you don't intend on playing specifically on MTGA)</li>
						<li><span class="option-name">Pick on Double Click</span>: Allows you to double click on booster cards during draft to pick without having to confirm.</li>
						<li><span class="option-name">Notifications</span>: If enabled, you will be notified when a draft is launched.</li>
						<li><span class="option-name">Session ID</span>: A unique identifier for your session, you can use any name, just make sure to use the same as your friends to play with them!</li>
						<li><span class="option-name">Card Display</span>: Adjusts the order of cards within a sealed pool or your drafted cards.</li>
					</ul>
				</div>
			</div>
		</div>
		<modal v-if="displayDraftLog && draftLog" @close="displayDraftLog = false">
			<h2 slot="header">Draft Log</h2>
			<div slot="body">
				<button type="button" @click="downloadLog">Download full log</button>
				
				Click on a player to display the details of their draft.
				
				<div>
					<ul :class="{'player-table': extendedDraftLog.length <= 8, 'player-list': extendedDraftLog.length > 8}">
						<li v-for="log of extendedDraftLog" :class="{clickable: log.userName != '(empty)', selected: log.userID == draftLogDisplayOptions.detailsUserID}" @click="if(log.userName != '(empty)') { draftLogDisplayOptions.detailsUserID = log.userID; }">
							{{log.userName}}
							<img src="img/mana/W.svg" class="mana-icon" v-if="log.colors['W'] >= 10" :title="log.colors['W']">
							<img src="img/mana/U.svg" class="mana-icon" v-if="log.colors['U'] >= 10" :title="log.colors['U']">
							<img src="img/mana/B.svg" class="mana-icon" v-if="log.colors['B'] >= 10" :title="log.colors['B']">
							<img src="img/mana/R.svg" class="mana-icon" v-if="log.colors['R'] >= 10" :title="log.colors['R']">
							<img src="img/mana/G.svg" class="mana-icon" v-if="log.colors['G'] >= 10" :title="log.colors['G']">	
						</li>
					</ul>
				</div>
				
				<div v-if="Object.keys(draftLog.users).includes(draftLogDisplayOptions.detailsUserID)" :set="log = draftLog.users[draftLogDisplayOptions.detailsUserID]">
					<h2>{{log.userName}}</h2>
					<select v-model="draftLogDisplayOptions.category">
						<option>Picks</options>
						<option>Cards<options>
					</select>
					<button @click="exportSingleLog(log.userID)">Export in MTGA format</button>
					<button @click="downloadMPT(log.userID)">Download in MTGO format</button>
					<button @click="submitToMPT(log.userID)">Submit to MagicProTools</button></h1>
					
					<template v-if="draftLogDisplayOptions.category == 'Picks'">
						<div v-for="(pick, index) in log.picks">
							<h3>Pick {{index + 1}}: {{cards[pick.pick].name}}</h3>
							<div class="card-container">
								<figure is="card" v-for="(card, index) in pick.booster" v-bind:key="index" v-bind:card="cards[card]" v-bind:language="language" :class="{'selected-high': pick.pick === card}"></figure>
							</div>
						</div>
					</template>
					<template v-else>
						<input type="checkbox" name="draft-log-card-list" v-model="draftLogDisplayOptions.textList"><label for="draft-log-card-list">Show simple card list</label>
						<template v-if="draftLogDisplayOptions.textList">
							<ol class="draft-log-boosters-list">
								<li v-for="card in log.cards">{{cards[card].printed_name[language]}}</li>
							</ol>
						</template>
						<template v-else>
							<div class="card-container">
								<figure is="card" v-for="(card, index) in log.cards" v-bind:key="index" v-bind:card="cards[card]" v-bind:language="language"></figure>
							</div>
						</template>
					</template>
				</div>
			</div>
		</modal>
		<modal v-if="showCollectionStats" @close="showCollectionStats = false">
			<h2 slot="header">Collection Statistics</h2>
			<div slot="body" v-if="collectionStats !== undefined">
				Select set:
				<select v-model="statsSelectedSet">
					<option v-for="set in sets" v-bind:value="set">{{ collectionStats[set].fullName }}</option>
				</select>
				<div class="set-stats">
					<div v-for="set in sets" v-show="statsSelectedSet === set">
						<table>
							<caption>{{collectionStats[set].fullName}}</caption>
							<tr><th>Rarity</th><th>Unique</th><th>Total</th><th>Total Missing</th><th>Unique (Booster)</th><th>Missing From Boosters</th></tr>
							<tr>
								<td>Total</td>
								<td>{{collectionStats[set].cards.filter(c => c.count > 0).length}}/{{collectionStats[set].total.unique}}</td>
								<td>{{collectionStats[set].cardCount}}/{{4 * collectionStats[set]['total']['unique']}}</td>
								<td>{{4 * collectionStats[set]['total']['unique'] - collectionStats[set].cardCount}}</td>
								<td>{{collectionStats[set].cards.filter(c => c.in_booster && c.count > 0).length}}/{{collectionStats[set].cards.filter(c => c.in_booster).length}}</td>
								<td>-</td>
							</tr>
							<tr v-for="r in ['common', 'uncommon', 'rare', 'mythic']" v-if="collectionStats[set][r + 'Count'] && collectionStats[set]['total'][r + 'Count'] > 0">
								<td>{{r}}</td>
								<td>{{collectionStats[set][r].filter(c => c.count > 0).length}}/{{collectionStats[set]['total'][r + 'Count']}}</td>
								<td>{{collectionStats[set][r + 'Count']}}/{{4 * collectionStats[set]['total'][r + 'Count']}}</td>
								<td>{{4 * collectionStats[set]['total'][r + 'Count'] - collectionStats[set][r + 'Count']}}</td>
								<td>{{collectionStats[set][r].filter(c => c.in_booster && c.count > 0).length}}/{{collectionStats[set][r].filter(c => c.in_booster).length}}</td>
								<td>{{4 * collectionStats[set][r].filter(c => c.in_booster).length - collectionStats[set][r].filter(c => c.in_booster).reduce((acc, val) => acc + val.count, 0)}}</td>
							</tr>
						</table>
						<h3>Missing <select v-model="statsMissingRarity"><option value="common">Commons</option><option value="uncommon">Uncommons</option><option value="rare">Rares</option><option value="mythic">Mythics</option></select> <input type="checkbox" id="show-non-booster" v-model="statsShowNonBooster"><label for="show-non-booster">Show non-booster cards</label>
						<div class="card-container">
							<figure is="missingCard" v-for="(card, index) in collectionStats[set].cards.filter(c => c.rarity == statsMissingRarity && (statsShowNonBooster || c.in_booster) && c.count < 4)" v-bind:key="index" v-bind:card="card" v-bind:language="language"></figure>
						</div>
					</div>
				</div>
			</div>
		</modal>
		<modal v-if="showSessionOptionsDialog" @close="showSessionOptionsDialog = false">
			<h2 slot="header">Additional Session Options</h2>
			<div slot="body" class="option-column">
				<div class="line" title="Share your session ID with everyone.">
					<label for="is-public">Public</label>
					<div class="right">
						<input type="checkbox" v-model="isPublic" id="is-public" title="Share your session ID with everyone." />
					</div>
				</div>
				<div class="line">
					<label for="max-players">Maximum Players</label>
					<div class="right">
						<input class="small-number-input" type="number" id="max-players" class="small-number-input" min="1" max="16" step="1" v-model.number="maxPlayers" />
					</div>
				</div>
				<div class="line" title="If set, the system will attempt to smooth out the color distribution in each pack, as opposed to being completely random.">
					<label for="colorBalance">Color Balance</label>
					<div class="right">
						<input type="checkbox" v-model="colorBalance">
					</div>
				</div>
				<div class="line" v-bind:class="{ disabled: useCustomCardList }" title="Limits the maximum rarity of cards in your pool. (Default is Mythic, which means no restriction. Also affects sealed)">
					<label for="maxRarity">Maximum Rarity</label>
					<div class="right">
						<select v-model="maxRarity">
							<option value="mythic">Mythic</option>
							<option value="rare">Rare</option>
							<option value="uncommon">Uncommon</option>
							<option value="common">Common</option>
						</select>
					</div>
				</div>
				<div class="line" v-bind:class="{ disabled: useCustomCardList }" title="Sets a duplicate limit for each rarity. Only used if no player collection is used to limit the card pool. Default values attempt to mimic a real booster box.">
					<label>Max. duplicate copies</label>
					<div class="right">
						<div><input class="small-number-input" type="number" id="max-duplicates-common" class="small-number-input" min="1" max="16" step="1" v-model.number="maxDuplicates['common']" /><label for="max-duplicates-common">for Commons</label></div>
						<div><input class="small-number-input" type="number" id="max-duplicates-uncommon" class="small-number-input" min="1" max="16" step="1" v-model.number="maxDuplicates['uncommon']" /><label for="max-duplicates-uncommon">for Uncommons</label></div>
						<div><input class="small-number-input" type="number" id="max-duplicates-mare" class="small-number-input" min="1" max="16" step="1" v-model.number="maxDuplicates['rare']" /><label for="max-duplicates-rare">for Rares</label></div>
						<div><input class="small-number-input" type="number" id="max-duplicates-mythic" class="small-number-input" min="1" max="16" step="1" v-model.number="maxDuplicates['mythic']" /><label for="max-duplicates-mythic">for Mythics</label></div>
					</div>
				</div>
				<div class="line" v-bind:class="{ disabled: useCustomCardList }" title="If enabled, each pack will have a chance to contain a 'foil' card of any rarity in place of one common.">
					<label for="colorBalance">Foil</label>
					<div class="right">
						<input type="checkbox" v-model="foil">
					</div>
				</div>
				<div class="line" title="Use a custom card list.">
					<label for="use-custom-card-list">Use a Custom Card List</label>
					<div class="right">
						<input type="checkbox" v-model="useCustomCardList" id="use-custom-card-list" title="Use a custom card list." />
					</div>
				</div>
				<div v-bind:class="{ disabled: !useCustomCardList }" class="line" title="Manage your custom card list.">
					<label for="card-list-input">Custom Card List</label>
					<div class="right">
						<input type="file" id="card-list-input" @change="parseCustomCardList" style="display:none" accept=".txt" /><button onclick="document.querySelector('#card-list-input').click()" title="Import your custom card list.">Upload <i  v-if="customCardList.length > 0" class="fas fa-check green" title="Card list uploaded."></i></button> <span v-if="customCardList.length > 0">{{customCardList.length}} cards in list.</span>
					</div>
				</div>
				<div class="option-info">Use services like <a href="https://www.cubetutor.com/">Cube Tutor</a> or <a href="https://cubecobra.com/">Cube Cobra</a> to craft your list, export it to .txt then upload it here. List format: One English card name by line. Boosters will be 15 cards without regards for rarity distribution.</div>
				<h4>Draft Specific Options</h4>
				<div class="line" title="Draft: Boosters per Player; default is 3.">
					<label for="boosters-per-player">Boosters per Player</label>
					<div class="right">
						<input type="number" id="boosters-per-player" class="small-number-input" min="1" max="25" step="1" v-model.number="boostersPerPlayer" />
					</div>
				</div>
				<div class="line" title="Who's going to receive the draft logs?">
					<label for="draft-log-recipients">Send draft logs to</label>
					<div class="right">
						<select v-model="draftLogRecipients" id="draft-log-recipients" />
							<option value="everyone">Everyone</option>
							<option value="owner">Owner only</option>
							<option value="delayed" title="Owner will choose when to make the draft public. Useful for tournaments.">Owner only, delayed</option>
							<option value="none">No-one</option>
						</select>
					</div>
				</div>
			</div>
		</modal>
		<modal v-if="displayAbout" @close="displayAbout = false">
			<h2 slot="header">About</h2>
			<div slot="body">
				<h3>Contact</h3>
				Senryoku: <a href="mailto:mtgadraft@gmail.com">mtgadraft@gmail.com</a>
				<h3>Support me</h3>
				<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
					<input type="hidden" name="cmd" value="_s-xclick" />
					<input type="hidden" name="hosted_button_id" value="6L2CUS6DH82DL" />
					<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_LG.gif" border="0" name="submit" title="PayPal - The safer, easier way to pay online!" alt="Donate with PayPal button" />
					<img alt="" border="0" src="https://www.paypal.com/en_FR/i/scr/pixel.gif" width="1" height="1" />
				</form>
				Currently this service only costs me time, but if you want to encourage me to maintain and improve it you can donate via PayPal, or just send me some feedback! :)
				<h3>Patch Notes</h3>
				<ol>
					<li>31/03/2020
						<ul>
							<li>Improved/Fixed card database.</li>
							<li>Fixed Conflux card exporting.</li>
						</ul>
					</li>
					<li>30/03/2020
						<ul>
							<li>Draggable cards option in deck builder.</li>
						</ul>
					</li>
					<li>29/03/2020
						<ul>
							<li>Added a Color Columns option to display cards.</li>
							<li>Added a Ready Check for the session owner.</li>
						</ul>
					</li>
					<li>28/03/2020
						<ul>
							<li>Updated draft logs. Complete pick information. Can now be exported in MTGO format/to MagicProTools.</li>
							<li>Fix: No more undesirable duplicates from the use of Color Balancing.</li>
							<li>Fix: Crash on reconnection.</li>
							<li>Fix: Correctly handle duplicates in Custom Card Lists.</li>
							<li>Fix: Correctly export split cards from Ravnica.</li>
						</ul>
					</li>
					<li>26/03/2020
						<ul>
							<li>Added a delayed draft log sharing option. Useful for tournament settings.</li>
						</ul>
					</li>
					<li>24/03/2020
						<ul>
							<li>Added a stop draft button for the owner.</li>
							<li>Updated visual of pick timer countdown.</li>
							<li>Draft logs can now be disabled or exclusive to the owner.</li>
							<li>Updated Draft Log with a table display.</li>
							<li>Display disconnected user name.</li>
						</ul>
					</li>
				</ol>
			</div>
		</modal>
		<footer>
			<span @click="displayAbout = true"><a>About</a></span>
			<span>Made by <a href="http://senryoku.github.io/">Senryoku</a></span>
			<span><a href="mailto:mtgadraft@gmail.com">Contact</a></span>
			<span>Get <a href="https://magic.wizards.com/fr/mtgarena">Magic: The Gathering Arena</a>
		</footer>
	</div>
	
	<!-- <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script> -->
	<script src="https://cdn.jsdelivr.net/npm/vue"></script>
	<script src="socket.io/socket.io.js"></script>
	<script type="text/javascript" src="js/helper.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@8"></script>
	<script src="https://unpkg.com/vue-multiselect@2.1.6"></script>
	<script src="//cdn.jsdelivr.net/npm/sortablejs@1.8.4/Sortable.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/Vue.Draggable/2.20.0/vuedraggable.umd.min.js"></script>
	<script type="text/javascript" src="js/constants.js"></script>
	<script type="text/javascript" src="js/cookies.js"></script>
	<script type="text/javascript" src="js/draft.js"></script>
</body>
</html>